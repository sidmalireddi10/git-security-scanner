# Secret detection patterns for the security scanner
# Each pattern includes a name, regex pattern, and severity level

patterns:
  - name: "AWS Access Key ID"
    pattern: "(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}"
    severity: "critical"
    description: "AWS Access Key ID detected"

  - name: "AWS Secret Access Key"
    pattern: "aws(.{0,20})?['\"][0-9a-zA-Z/+]{40}['\"]"
    severity: "critical"
    description: "AWS Secret Access Key detected"

  - name: "GitHub Personal Access Token"
    pattern: "ghp_[a-zA-Z0-9]{36}"
    severity: "critical"
    description: "GitHub Personal Access Token detected"

  - name: "GitHub OAuth Token"
    pattern: "gho_[a-zA-Z0-9]{36}"
    severity: "critical"
    description: "GitHub OAuth Token detected"

  - name: "GitHub App Token"
    pattern: "(ghu|ghs)_[a-zA-Z0-9]{36}"
    severity: "critical"
    description: "GitHub App Token detected"

  - name: "GitHub Refresh Token"
    pattern: "ghr_[a-zA-Z0-9]{76}"
    severity: "critical"
    description: "GitHub Refresh Token detected"

  - name: "Generic API Key"
    pattern: "(?i)(api[_-]?key|apikey)[_-]?[=:]['\"]?[a-zA-Z0-9]{32,}['\"]?"
    severity: "high"
    description: "Generic API Key pattern detected"

  - name: "Private SSH Key"
    pattern: "-----BEGIN (RSA|DSA|EC|OPENSSH) PRIVATE KEY-----"
    severity: "critical"
    description: "Private SSH Key detected"

  - name: "Generic Private Key"
    pattern: "-----BEGIN PRIVATE KEY-----"
    severity: "critical"
    description: "Generic Private Key detected"

  - name: "PGP Private Key"
    pattern: "-----BEGIN PGP PRIVATE KEY BLOCK-----"
    severity: "critical"
    description: "PGP Private Key detected"

  - name: "Slack Token"
    pattern: "xox[baprs]-([0-9a-zA-Z]{10,48})"
    severity: "high"
    description: "Slack Token detected"

  - name: "Slack Webhook"
    pattern: "https://hooks.slack.com/services/T[a-zA-Z0-9_]{8}/B[a-zA-Z0-9_]{8}/[a-zA-Z0-9_]{24}"
    severity: "high"
    description: "Slack Webhook URL detected"

  - name: "Stripe API Key"
    pattern: "(sk|pk)_(live|test)_[0-9a-zA-Z]{24,}"
    severity: "critical"
    description: "Stripe API Key detected"

  - name: "Google API Key"
    pattern: "AIza[0-9A-Za-z\\-_]{35}"
    severity: "high"
    description: "Google API Key detected"

  - name: "Google OAuth"
    pattern: "[0-9]+-[0-9A-Za-z_]{32}\\.apps\\.googleusercontent\\.com"
    severity: "high"
    description: "Google OAuth credential detected"

  - name: "Heroku API Key"
    pattern: "[hH][eE][rR][oO][kK][uU].*[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}"
    severity: "high"
    description: "Heroku API Key detected"

  - name: "Generic Password"
    pattern: "(?i)(password|passwd|pwd)[_-]?[=:]['\"]?[^\\s'\"]{8,}['\"]?"
    severity: "medium"
    description: "Generic password pattern detected"

  - name: "Database Connection String"
    pattern: "(mongodb|mysql|postgres|postgresql)://[^\\s]+"
    severity: "high"
    description: "Database connection string detected"

  - name: "JWT Token"
    pattern: "eyJ[A-Za-z0-9-_=]+\\.eyJ[A-Za-z0-9-_=]+\\.[A-Za-z0-9-_.+/=]+"
    severity: "medium"
    description: "JWT token detected"

  - name: "Bearer Token"
    pattern: "(?i)bearer [a-zA-Z0-9_\\-\\.=]+"
    severity: "medium"
    description: "Bearer token detected"

  - name: "NPM Token"
    pattern: "npm_[a-zA-Z0-9]{36}"
    severity: "high"
    description: "NPM token detected"

  - name: "PyPI Token"
    pattern: "pypi-AgEIcHlwaS5vcmc[A-Za-z0-9-_]{50,}"
    severity: "high"
    description: "PyPI token detected"

  - name: "Docker Hub Token"
    pattern: "(?i)dockerhub.*['\"][a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}['\"]"
    severity: "high"
    description: "Docker Hub token detected"

  - name: "Azure Connection String"
    pattern: "(?i)DefaultEndpointsProtocol=https;AccountName=[^;]+;AccountKey=[^;]+;"
    severity: "critical"
    description: "Azure connection string detected"

# File extensions that should never contain secrets
forbidden_extensions:
  - ".pem"
  - ".key"
  - ".p12"
  - ".pfx"
  - ".cer"
  - ".crt"
  - ".der"

# Files that commonly contain secrets
sensitive_files:
  - ".env"
  - ".env.local"
  - ".env.production"
  - "credentials.json"
  - "config.yml"
  - "secrets.yml"
  - "id_rsa"
  - "id_dsa"
